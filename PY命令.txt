pip install ·   
streamlit run C:\Users\Administrator\Desktop\PY\app1.py
streamlit run C:\Users\11414\Desktop\PY\app1.py
1.   用 Python 实现：
- 读取  C:\Users\Administrator\Desktop\PY\售后数据处理\售后数据.xlsx    文件
- 删除   故障部位标签 列中空白单元格的所有行 
- 只保留  物料组（改名为 产品类型）、SN扫码结果（删除首字母非R的行）、服务工单类型、产品系列、创建时间列（只保留年/月，日期格式 25-01）、故障部位标签、故障部位、故障码、故障现象 ，其余列均删除 
- 问题产生时间 列后插入新的一列，列名： 故障数 ，填充该列所有单元格数值为 1 
- SN扫码结果 列，提取第8-9个字符，并创建新列 '生产批次'，    df['生产批次'] = '202'+df['SN扫码结果'].str[6:7] + '-' + df['SN扫码结果'].str[7:9] 
-将生产批次列内容 ，示例2025-01 转化成日期格式：25-01
-创建新列：‘累计销量’，读取C:\Users\Administrator\Desktop\PY\售后数据处理\销量数据.xlsx  ，A列中产品名称 内容与 产品系列 内容一致，将B列对应行数据 输入在‘累计销量’对应行 
- 创建新列： ‘AFR’，将 故障数/累计销量，结果输入对应行单元格 
- 文件格式需求：所有列文字 居中 ，列宽20，表头为蓝色字体 
- 结果保存到 C:\Users\Administrator\Desktop\PY\售后数据处理   命名  数据处理  
-按 产品类型 区分 ‘产品_扫地机器人’ 和 ‘产品_家用洗地机’ ，分成两个Sheet表并命名 


2. 生成完整功能代码 
- 直接读取C:\Users\Administrator\Desktop\PY\售后数据处理\数据处理.xlsx
- 读取行标题： 产品类型、SN扫码结果、服务工单类型、产品系列、创建时间、故障部位标签、故障部位、故障码、故障现象、生产批次、累计销量、AFR

- 通过 streamlit  搭建界面
- 主界面：标题写入：st.header 《石头售后质量一览》微软雅黑+红色字体+40+居中
- 主界面：增加 产品类型 模块，两个按钮分别为 售后数据.xlsx 文件下的  第一个sheet "产品_扫地机器人" 和 第二个 sheeet "产品_家用洗地机" 

- 左侧栏：增加 产品系列、故障部位标签、故障部位、故障码  下拉框  灰色背景
- 功能：选择 产品系列、故障部位标签、故障部位、故障码（信息联动 ，比如我选择不同的 产品系列，对应 故障部位标签  数据刷新并按照故障总数排序），
- 功能：所有下拉框增加  全选 选项，即我选择 '全选' 默认选择所有数据
- 功能：选择不同下拉框信息输出不同的柱状+折线 图

- 月度故障不良： X轴  创建时间  和  Y轴 故障数（柱状图，左轴）+ 故障率 ‘AFR’= 故障数 /累计销量 （这里每个单元格累计销量代表的是对应产品系列下所有销量，所以除以一个单元格销量即可，不需要将累计销量进行累加），右轴，百分比保留2位小数） 
- 周度故障不良： X轴  生产批次  和  Y轴 故障数（柱状图，左轴）+ 故障率 ‘AFR’= 故障数 / 累计销量（这里每个单元格累计销量代表的是对应产品系列下所有销量，所以除以一个单元格销量即可，不需要将累计销量进行累加），右轴，百分比保留2位小数）
- 在柱状图和折线图的每个点上显示具体的数据值，柱状图的数值显示在柱状图正中间
-直接以文本格式作为 X 轴，不需要进行任何时间格式的转换
-X轴 字体斜向上45° plt.xticks(rotation=45，避免重叠
-再生成一个图表，针对 故障部位标签 下的Top10（按故障数） ，X轴 故障部位标签 的Top10 ，  Y轴 故障数+增加对应 AFR（故障数/销量），图表样式和其它图表一致，生成代码

运行 streamlit 实现  




不改其它代码，只在CSS里面优化下，我想把 月度故障不良分析 和 周度故障不良分析 并排放在同一行，尺寸配置各占一半界面 
同样 故障部位-Top10 和  用户体验-Top10  并排放在同一行，尺寸配置各占一半界面 
CSS界面帮我在完美下 感谢 感谢 


我想选择 故障周数 - 输出对应周度


